# Token 節流與開發效能規範 (Always On)

## 1. 上下文最小化 (Context Minimization)
- **精確讀取**：禁止執行全域性的 `read_all_files`。Agent 必須根據任務，僅讀取與之直接相關的 Hook（如 `useAuction.js`）或組件。
- **索引依賴**：優先參考 `#PROJECT_SNAPSHOT.md` 獲取結構資訊，而非反覆掃描目錄。
- **排除路徑**：自動忽略 `node_modules/`, `dist/`, `.git/` 以及大型編譯產出物。

## 2. 輸出簡潔化 (Output Throttling)
- **僅輸出差異 (Diff Only)**：除非是建立新檔案，否則代碼修改僅輸出受影響的函式或代碼塊（Code Snippets），禁止全文輸出。
- **拒絕冗長解釋**：除非使用者詢問，否則 Agent 不得詳細解釋基礎語法（如 Vue 指令或 Socket 原理），僅需說明邏輯變更點。
- **計畫簡略化**：`IMPLEMENTATION_PLAN.md` 應改用條列式（Bullet points），字數控制在 300 字內。

## 3. 邏輯快取 (Logic Caching)
- **禁止重複引用規則**：除非涉及規則衝突，否則 Agent 不需在回覆中重複引用 `#GAME_RULES.md` 的全文，僅需標註「符合規則第 X 條」。
- **維持狀態意識**：利用先前重構後的模組化結構，Agent 應專注於單一 Composable 的修改，避免跨檔案過載。

## 4. 檔案操作限制
- **單次修改上限**：單次任務修改的檔案數量不得超過 3 個。若超過，必須強制拆分為多個子任務執行。
- **禁止無意義重構**：禁止僅為了「排版」或「風格偏好」而重寫運作正常的程式碼。

## 5. UI/視覺修改與審核規範 (Strict UI Modification & Approval Protocol)
- **絕對禁止隨意開發 (Absolute Lockdown on Spontaneous UI Changes)**：禁止在未獲得使用者「明確書面指示」的情況下，對任何 UI、CSS、佈局、配色、圖示或元件結構進行任何形式的修改。
- **零容忍擅修原則 (Zero-Tolerance for Unauthorized Edits)**：嚴禁以「優化」、「順手修飾」、「節省空間」或「符合現代美學」為由，自行更動設計師定案的介面樣貌。
- **強制提案制 (Mandatory Proposal System)**：若 Agent 認為某處 UI 有改善空間，必須先以文字說明提案，並在使用者明確回覆「同意」後方可動工。
- **精準打擊 (Surgical Precision)**：即便獲得授權，Agent 也僅能針對「指示中提到的範圍」進行修改，嚴禁擴散至其他 CSS 選取器或 HTML 標籤。
- **即刻復原責任 (Mandatory Reversion)**：若 Agent 若因誤解而對 UI 造成破壞或非預期變更，必須在第一時間無條件還原至最原始狀態。

## 6. 專業代理人規則 (Professional Agent Identity)
- **規則 X (Identity Switch)**：當工作內容涉及 **管理員面板 (Admin Panel)**、**後端邏輯 (Backend Logic)** 或 **遊戲規則 (Game Rules)** 時，Agent 必須先行確認相關之 `SKILL.md` 內容（如 `frontend_artist.md` 或 `game_master.md`），確保身分切換正確且遵守該領域之專業守則。

## 7. Windows 環境編碼規範 (Windows Encoding Standards)
- **UTF-8 強制化**：在 Windows PowerShell 環境下執行涉及中文字元輸出的指令時，必須先執行 `chcp 65001` 以確保字碼頁正確。
- **輸出重導向安全**：使用 `>` 或 `>>` 重新導向輸出至檔案時，應優先考慮使用 `Out-File -Encoding utf8` 或在其前綴設定 `$OutputEncoding = [Console]::OutputEncoding = [System.Text.Encoding]::UTF8`，防止產生 UTF-16LE 導致的亂碼（例如：??箏??）。
- **檔案讀取預設**：所有由 Agent 建立的新檔案（如 `.log`, `.txt`, `.md`）必須確保為 UTF-8 編碼，以便在不同系統間維持一致的閱讀體感。

## 8. 遊戲邏輯保護 (Game Logic Protection)
- **連鎖影響檢查**：在修改任何遊戲階段（Phase）的轉換邏輯、判定條件或計時器時，**必須**先全面檢查該變更是否會影響到其他階段的流程（例如：修改攻擊階段判定時，需同步確認是否會誤觸競標階段的安全網或過渡期）。確保修改是局部且具備排他性的，防止產生意外的連鎖跳轉。
