# æ£®æ—é€²åŒ–éŠæˆ² - å°ˆæ¡ˆå¿«ç…§ (PROJECT SNAPSHOT)

> **ç”Ÿæˆæ™‚é–“**: 2026-02-01  
> **å°ˆæ¡ˆç‰ˆæœ¬**: 1.7.0 (Baseline Stable)  
> **ç›®çš„**: è¨˜éŒ„å°ˆæ¡ˆæ¶æ§‹ã€æ ¸å¿ƒé‚è¼¯ä½ç½®èˆ‡é—œéµæª”æ¡ˆ,ä¾›é–‹ç™¼è€…å¿«é€Ÿç†è§£å°ˆæ¡ˆå…¨è²Œ

---

## ğŸ“ å°ˆæ¡ˆè³‡æ–™å¤¾çµæ§‹

```
forest-evolution-game/
â”œâ”€â”€ client/                          # å‰ç«¯æ‡‰ç”¨ (Vue 3 + Vite)
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ admin.html              # ç®¡ç†å“¡é é¢ (éœæ…‹)
â”‚   â”‚   â””â”€â”€ vite.svg
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/             # Vue å…ƒä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ AdminPanel.vue      # ç®¡ç†å“¡æ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ AuctionModal.vue    # ç«¶æ¨™å½ˆçª—
â”‚   â”‚   â”‚   â”œâ”€â”€ GameRules.vue       # éŠæˆ²è¦å‰‡é¡¯ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerDashboard.vue # ç©å®¶å„€è¡¨æ¿
â”‚   â”‚   â”‚   â””â”€â”€ SkillSelectionModal.vue # æŠ€èƒ½é¸æ“‡å½ˆçª—
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ gameHelpers.js      # éŠæˆ²è¼”åŠ©å‡½å¼
â”‚   â”‚   â”œâ”€â”€ App.vue                 # ä¸»æ‡‰ç”¨å…ƒä»¶ (æ ¸å¿ƒ UI é‚è¼¯)
â”‚   â”‚   â”œâ”€â”€ main.js                 # Vue æ‡‰ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ socketService.js        # Socket.IO å®¢æˆ¶ç«¯æœå‹™
â”‚   â”‚   â””â”€â”€ style.css               # å…¨åŸŸæ¨£å¼
â”‚   â”œâ”€â”€ index.html                  # HTML å…¥å£
â”‚   â”œâ”€â”€ vite.config.js              # Vite è¨­å®š
â”‚   â””â”€â”€ package.json                # å‰ç«¯ä¾è³´
â”‚
â”œâ”€â”€ server/                          # å¾Œç«¯æ‡‰ç”¨ (Node.js + Express + Socket.IO)
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ gameConstants.js        # éŠæˆ²å¸¸æ•¸ (æŠ€èƒ½ã€ç­‰ç´šã€å±¬æ€§)
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ gameModel.js            # éŠæˆ²è³‡æ–™æ¨¡å‹ (MongoDB Schema)
â”‚   â”‚   â””â”€â”€ playerModel.js          # ç©å®¶è³‡æ–™æ¨¡å‹ (MongoDB Schema)
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ gameRoutes.js           # API è·¯ç”±å®šç¾©
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ gameService.js          # æ ¸å¿ƒéŠæˆ²é‚è¼¯æœå‹™
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â””â”€â”€ full-round-test.js      # å®Œæ•´å›åˆæ¸¬è©¦
â”‚   â”œâ”€â”€ server.js                   # ä¼ºæœå™¨å…¥å£
â”‚   â””â”€â”€ package.json                # å¾Œç«¯ä¾è³´
â”‚
â”œâ”€â”€ tests/                           # æ¸¬è©¦è…³æœ¬
â”‚   â”œâ”€â”€ full_game_simulation_8p.js  # 8 äººéŠæˆ²æ¨¡æ“¬
â”‚   â”œâ”€â”€ test_battle_logic_standalone.js # æˆ°é¬¥é‚è¼¯æ¸¬è©¦
â”‚   â””â”€â”€ test_distribution_logic.js  # å±¬æ€§åˆ†é…æ¸¬è©¦
â”‚
â”œâ”€â”€ GAME_RULES.md                    # éŠæˆ²è¦å‰‡æ–‡ä»¶
â”œâ”€â”€ modification_history.md          # ä¿®æ”¹æ­·å²ç´€éŒ„
â”œâ”€â”€ render.yaml                      # Render éƒ¨ç½²è¨­å®š
â”œâ”€â”€ package.json                     # æ ¹ç›®éŒ„ä¾è³´ (æ•´åˆç”¨)
â””â”€â”€ .env                             # ç’°å¢ƒè®Šæ•¸ (MongoDB URI ç­‰)
```

---

## ğŸ¯ æ ¸å¿ƒé‚è¼¯ä½ç½®

### 1ï¸âƒ£ **å±¬æ€§ç›¸å‰‹ç³»çµ±**

**æª”æ¡ˆ**: `server/services/gameService.js`  
**å‡½å¼**: `handleSingleAttack()` (ç¬¬ 226-350 è¡Œ)

```javascript
// æ ¸å¿ƒé‚è¼¯ä½ç½® (ç¬¬ 258-296 è¡Œ)
const attributeRules = { 'æœ¨': 'æ°´', 'æ°´': 'ç«', 'ç«': 'æœ¨' };

// åˆ¤å®šé‚è¼¯
if (attacker.attribute === target.attribute) 
    attackSuccess = attacker.level > target.level;
else if (attacker.attribute === 'é›·' || target.attribute === 'é›·') 
    attackSuccess = true;
else if (attributeRules[attacker.attribute] === target.attribute) 
    attackSuccess = true;
else if (attributeRules[target.attribute] === attacker.attribute) 
    attackSuccess = false;
```

**ç›¸å‰‹è¦å‰‡**:

- æœ¨å‰‹æ°´ã€æ°´å‰‹ç«ã€ç«å‰‹æœ¨
- é›·å±¬æ€§ç‰¹æ®Š: æ‰“äººå¿…ä¸­ã€è¢«æ‰“å¿…ä¸­ã€é›·æ‰“é›·çœ‹ç­‰ç´š

---

### 2ï¸âƒ£ **å‚·å®³è¨ˆç®—ç³»çµ±**

**æª”æ¡ˆ**: `server/services/gameService.js`  
**å‡½å¼**: `handleSingleAttack()` å…§çš„ `damageCalculator()` (ç¬¬ 298-302 è¡Œ)

```javascript
const damageCalculator = (winner, loser) => {
    const effectiveDefense = winner.skills.includes('ç ç‰™') ? 0 : loser.defense;
    const adrenalineBonus = (winner.skills.includes('è…ä¸Šè…ºç´ ') && winner.hp < 10) ? 3 : 0;
    return Math.max(1, winner.attack + (roundBonus[game.currentRound] || 0) + adrenalineBonus - effectiveDefense);
};
```

**å‚·å®³å…¬å¼**:

```
å‚·å®³ = Max(1, æ”»æ“ŠåŠ› + å›åˆåŠ æˆ + æŠ€èƒ½åŠ æˆ - é˜²ç¦¦åŠ›)
```

**å›åˆåŠ æˆ** (ç¬¬ 288 è¡Œ):

- ç¬¬ 1 å›åˆ: +3
- ç¬¬ 2 å›åˆ: +4
- ç¬¬ 3 å›åˆ: +5
- ç¬¬ 4 å›åˆ: +7

**æŠ€èƒ½å½±éŸ¿**:

- `ç ç‰™`: ç„¡è¦–é˜²ç¦¦åŠ›
- `è…ä¸Šè…ºç´ `: HP < 10 æ™‚æ”»æ“ŠåŠ› +3
- `é©è€…ç”Ÿå­˜`: æ”»æ“ŠæˆåŠŸå¾Œæ”»æ“ŠåŠ› +2
- `å°–åˆº`: åå½ˆä¸€åŠå‚·å®³
- `å—œè¡€`: æ”»æ“ŠæˆåŠŸæ¢å¾© 2 HP

---

### 3ï¸âƒ£ **ç«¶æ¨™ç³»çµ±**

**æª”æ¡ˆ**: `server/services/gameService.js`  
**æ ¸å¿ƒå‡½å¼**:

| å‡½å¼åç¨± | è¡Œæ•¸ | åŠŸèƒ½ |
|---------|------|------|
| `startAuctionForSkill()` | 113-135 | é–‹å§‹å–®ä¸€æŠ€èƒ½ç«¶æ¨™ (5ç§’å€’æ•¸) |
| `transitionToActive()` | 87-111 | è½‰æ›ç‚ºç«¶æ¨™é€²è¡Œä¸­ (120ç§’) |
| `settleSkillAuction()` | 137-169 | çµç®—ç«¶æ¨™çµæœ |
| `finalizeAuctionPhase()` | 171-224 | å®Œæˆæ‰€æœ‰ç«¶æ¨™,é€²å…¥ä¸‹å›åˆ |

**ç«¶æ¨™æµç¨‹**:

1. ç®¡ç†å“¡é–‹å§‹æ”»æ“Šéšæ®µ â†’ è§¸ç™¼ç«¶æ¨™
2. æ¯å€‹æŠ€èƒ½ä¾åºç«¶æ¨™ (5ç§’æº–å‚™ + 120ç§’ç«¶æ¨™)
3. åƒ¹é«˜è€…å¾—,æ‰£é™¤ HP ä¸¦ç²å¾—æŠ€èƒ½
4. æ‰€æœ‰æŠ€èƒ½ç«¶æ¨™å®Œç•¢ â†’ é€²å…¥ä¸‹ä¸€å›åˆè¨è«–éšæ®µ

**å‡ºåƒ¹è¦å‰‡** (`server/routes/gameRoutes.js` ç¬¬ 297-336 è¡Œ):

- å¿…é ˆä¿ç•™è‡³å°‘ 5 HP
- é‡è¤‡å‡ºåƒ¹æœƒå°‡åŸå‡ºåƒ¹åŠ å›å¯ç”¨é ç®—
- æœ€å¾Œ 10 ç§’å…§å‡ºåƒ¹æœƒè‡ªå‹•åŠ æ™‚ 10 ç§’

---

## ğŸ› ï¸ æŠ€è¡“æ£§

### **å‰ç«¯**

- **æ¡†æ¶**: Vue 3 (Composition API)
- **å»ºç½®å·¥å…·**: Vite (rolldown-vite@7.1.14)
- **å³æ™‚é€šè¨Š**: Socket.IO Client 4.8.1
- **HTTP è«‹æ±‚**: Axios 1.12.2
- **æ¨£å¼**: Vanilla CSS (å«å‹•ç•«ã€éŸ¿æ‡‰å¼è¨­è¨ˆ)

### **å¾Œç«¯**

- **åŸ·è¡Œç’°å¢ƒ**: Node.js
- **æ¡†æ¶**: Express 5.1.0
- **å³æ™‚é€šè¨Š**: Socket.IO 4.8.1
- **è³‡æ–™åº«**: MongoDB (Mongoose 8.19.1)
- **ç’°å¢ƒè®Šæ•¸**: dotenv 17.2.3
- **è·¨åŸŸ**: CORS 2.8.5

### **éƒ¨ç½²**

- **å¹³å°**: Render (åƒè€ƒ `render.yaml`)
- **è³‡æ–™åº«**: MongoDB Atlas

---

## âš ï¸ æ ¸å¿ƒæª”æ¡ˆæ¸…å–® (çµ•å°ä¸èƒ½éš¨ä¾¿å¤§æ”¹)

### 1. `server/services/gameService.js` (550 è¡Œ)

**é‡è¦æ€§**: â­â­â­â­â­  
**åŸå› **: åŒ…å«æ‰€æœ‰æ ¸å¿ƒéŠæˆ²é‚è¼¯

- å±¬æ€§ç›¸å‰‹åˆ¤å®š
- å‚·å®³è¨ˆç®—
- æŠ€èƒ½æ•ˆæœå¯¦ä½œ (15+ ç¨®æŠ€èƒ½)
- ç«¶æ¨™æµç¨‹æ§åˆ¶
- æ”»æ“Šæµç¨‹ (å«ç…å­ç‹æ‰‹ä¸‹æ”»æ“Š)
- å‚·å®³é€£çµ (åŒç—…ç›¸æ†)

**ä¿®æ”¹å»ºè­°**: ä»»ä½•æ”¹å‹•éƒ½è¦å…ˆå¯«æ¸¬è©¦,ç¢ºä¿ä¸ç ´å£ç¾æœ‰é‚è¼¯

---

### 2. `server/config/gameConstants.js` (49 è¡Œ)

**é‡è¦æ€§**: â­â­â­â­â­  
**åŸå› **: å®šç¾©éŠæˆ²å¹³è¡¡æ€§çš„æ ¸å¿ƒæ•¸å€¼

- æŠ€èƒ½æ¸…å–®èˆ‡æè¿° (æŒ‰å›åˆåˆ†é¡)
- ç­‰ç´šç´ è³ª (æ”»æ“Š/é˜²ç¦¦)
- å‡ç´šæ¶ˆè€—
- åˆå§‹ HP

**ä¿®æ”¹å»ºè­°**: æ”¹å‹•æ•¸å€¼å‰è¦å…ˆè©•ä¼°å°éŠæˆ²å¹³è¡¡çš„å½±éŸ¿

---

### 3. `client/src/App.vue` (1870 è¡Œ)

**é‡è¦æ€§**: â­â­â­â­  
**åŸå› **: å‰ç«¯æ ¸å¿ƒé‚è¼¯èˆ‡ UI

- éŠæˆ²ç‹€æ…‹ç®¡ç†
- Socket.IO äº‹ä»¶è™•ç†
- æŠ€èƒ½ä½¿ç”¨é‚è¼¯
- ç«¶æ¨™ä»‹é¢
- ç©å®¶äº’å‹• UI

**ä¿®æ”¹å»ºè­°**: UI æ”¹å‹•å¯ä»¥,ä½†è¦å°å¿ƒä¸è¦ç ´å£ç‹€æ…‹åŒæ­¥é‚è¼¯

---

### 4. `server/models/gameModel.js` & `playerModel.js`

**é‡è¦æ€§**: â­â­â­â­  
**åŸå› **: è³‡æ–™åº« Schema å®šç¾©

- éŠæˆ²ç‹€æ…‹çµæ§‹
- ç©å®¶å±¬æ€§çµæ§‹
- ç«¶æ¨™ç‹€æ…‹
- å›åˆçµ±è¨ˆ

**ä¿®æ”¹å»ºè­°**: Schema æ”¹å‹•æœƒå½±éŸ¿ç¾æœ‰è³‡æ–™,éœ€è¦è³‡æ–™é·ç§»è…³æœ¬

---

### 5. `server/routes/gameRoutes.js` (455 è¡Œ)

**é‡è¦æ€§**: â­â­â­â­  
**åŸå› **: API ç«¯é»å®šç¾©

- éŠæˆ²å»ºç«‹/åŠ å…¥/é–‹å§‹
- æ”»æ“Š/ç«¶æ¨™/æŠ€èƒ½ä½¿ç”¨
- ç®¡ç†å“¡åŠŸèƒ½ (è¸¢äººã€æ›´æ–°ç©å®¶)
- å±¬æ€§åµæŸ¥

**ä¿®æ”¹å»ºè­°**: API æ”¹å‹•è¦åŒæ­¥æ›´æ–°å‰ç«¯å‘¼å«

---

## ğŸ“Š è³‡æ–™æµå‘

```
ä½¿ç”¨è€…æ“ä½œ (App.vue)
    â†“
Socket.IO / HTTP API (socketService.js / axios)
    â†“
å¾Œç«¯è·¯ç”± (gameRoutes.js)
    â†“
éŠæˆ²æœå‹™å±¤ (gameService.js)
    â†“
è³‡æ–™åº«æ¨¡å‹ (gameModel.js / playerModel.js)
    â†“
MongoDB Atlas
    â†“
Socket.IO å»£æ’­ (broadcastGameState)
    â†“
æ‰€æœ‰å®¢æˆ¶ç«¯æ›´æ–° UI
```

---

## ğŸ”§ å¸¸ç”¨æŒ‡ä»¤

### é–‹ç™¼ç’°å¢ƒ

```bash
# å®‰è£ä¾è³´
npm run build

# å•Ÿå‹•å¾Œç«¯ (é–‹ç™¼)
cd server && npm run start

# å•Ÿå‹•å‰ç«¯ (é–‹ç™¼)
cd client && npm run dev
```

### ç”Ÿç”¢ç’°å¢ƒ

```bash
# å»ºç½®å‰ç«¯
cd client && npm run build

# å•Ÿå‹•ä¼ºæœå™¨ (æœƒè‡ªå‹•æœå‹™å‰ç«¯éœæ…‹æª”æ¡ˆ)
npm start
```

---

## ğŸ“ é‡è¦è¨­å®šæª”

| æª”æ¡ˆ | ç”¨é€” |
|------|------|
| `.env` | MongoDB é€£ç·šå­—ä¸²ã€ç’°å¢ƒè®Šæ•¸ |
| `render.yaml` | Render éƒ¨ç½²è¨­å®š |
| `client/vite.config.js` | Vite å»ºç½®è¨­å®š |
| `GAME_RULES.md` | å®Œæ•´éŠæˆ²è¦å‰‡æ–‡ä»¶ |
| `modification_history.md` | ç‰ˆæœ¬ä¿®æ”¹ç´€éŒ„ |

---

## ğŸ® éŠæˆ²æ ¸å¿ƒæ©Ÿåˆ¶ç¸½çµ

1. **å±¬æ€§ç³»çµ±**: æœ¨/æ°´/ç«/é›·,ç›¸å‰‹é—œä¿‚æ±ºå®šæ”»æ“Šæˆæ•—
2. **ç­‰ç´šç³»çµ±**: Lv0-3,æ¶ˆè€— HP å‡ç´š,æå‡æ”»æ“Š/é˜²ç¦¦
3. **å›åˆåˆ¶**: è¨è«–éšæ®µ â†’ æ”»æ“Šéšæ®µ â†’ ç«¶æ¨™éšæ®µ â†’ ä¸‹ä¸€å›åˆ
4. **æŠ€èƒ½ç³»çµ±**: 15+ ç¨®æŠ€èƒ½,åˆ†ç‚ºè¢«å‹•/ä¸»å‹•/ä¸€æ¬¡æ€§
5. **ç«¶æ¨™ç³»çµ±**: ç›²æ¨™,åƒ¹é«˜è€…å¾—,æ‰£é™¤ HP
6. **å‹åˆ©æ¢ä»¶**: æœ€å¾Œå­˜æ´»æˆ–è¡€é‡æœ€é«˜è€…

---

## ğŸš¨ å·²çŸ¥é™åˆ¶èˆ‡æ³¨æ„äº‹é …

1. **å‰ä¸‰å›åˆä¿è­·**: æ¯ä½ç©å®¶æ¯å›åˆåªèƒ½è¢«æ”»æ“Šä¸€æ¬¡
2. **åæ“Šé™åˆ¶**: ç„¡æ³•æ”»æ“Šæœ¬å›åˆå·²æ”»æ“Šéä½ çš„ç©å®¶
3. **ç…å­ç‹é™åˆ¶**: å ´ä¸Šåƒ…å‰© 2 äººæ™‚ç„¡æ³•æŒ‡å®šæ‰‹ä¸‹
4. **ç«¶æ¨™ä¿ç•™**: å¿…é ˆä¿ç•™è‡³å°‘ 5 HP æ‰èƒ½å‡ºåƒ¹
5. **å±¬æ€§åˆ†é…**: æœ¨/æ°´/ç« å¹³å‡åˆ†é…,å¤šé¤˜åé¡çµ¦é›·

---

**æ–‡ä»¶çµæŸ** - å¦‚éœ€æ›´æ–°æ­¤æ–‡ä»¶,è«‹åŒæ­¥æ›´æ–° `modification_history.md`
